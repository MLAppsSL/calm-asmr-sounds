---
phase: 03-core-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/_layout.tsx
  - app/(tabs)/_layout.tsx
  - app/(tabs)/index.tsx
  - app/(tabs)/now-playing.tsx
  - app/(tabs)/favorites.tsx
  - app/(onboarding)/_layout.tsx
  - src/data/sounds.ts
  - src/stores/uiStore.ts
  - src/components/SoundCard.tsx
  - src/components/CategorySection.tsx
autonomous: true
requirements:
  - LIB-01
  - LIB-02
  - LIB-03

must_haves:
  truths:
    - "The app launches and renders the library screen showing 15+ sounds grouped by category sections (Nature, Ambient, etc.)"
    - "Each sound card shows: image background with gradient overlay, sound name, subtitle, clip duration, and PRO/lock badge in the top-right corner"
    - "Category sections scroll horizontally and independently — no filter tabs, no 'View all' links"
    - "The bottom tab bar renders with frosted-glass BlurView and 4 tabs: Home, graphic_eq, Favorites, Settings"
    - "Tapping a sound card pushes the /player route (player screen exists as sibling of (tabs) in root Stack)"
    - "Dark mode preference (isDarkMode) is readable from uiStore by any screen in Phase 3"
  artifacts:
    - path: "src/data/sounds.ts"
      provides: "Static sound manifest: 17 sounds across 4 categories (rain, fire, forest, wave) with id, name, subtitle, category, duration, isPremium, imageAsset fields"
      min_lines: 60
    - path: "src/stores/uiStore.ts"
      provides: "Zustand persisted uiStore with isDarkMode (default: true), _hasHydrated, toggleDarkMode, setHasHydrated"
      exports: ["useUIStore"]
    - path: "src/components/SoundCard.tsx"
      provides: "Square card component with expo-image bg, LinearGradient overlay, name, subtitle, duration, conditional PRO pill or lock badge"
      min_lines: 60
    - path: "src/components/CategorySection.tsx"
      provides: "Section title + horizontal FlatList of SoundCards with snap behavior (snapToAlignment=start, decelerationRate=fast)"
      min_lines: 30
    - path: "app/_layout.tsx"
      provides: "Root Stack with (onboarding), (tabs), and player as sibling screens; SplashScreen.preventAutoHideAsync() called at module level"
    - path: "app/(tabs)/_layout.tsx"
      provides: "4-tab Tabs navigator with frosted BlurView tabBarBackground; position:absolute tab bar so content extends beneath"
    - path: "app/(tabs)/index.tsx"
      provides: "Library screen: outer vertical FlatList of CategorySection items — NOT a ScrollView wrapping FlatLists"
  key_links:
    - from: "app/(tabs)/index.tsx"
      to: "src/components/CategorySection.tsx"
      via: "FlatList renderItem"
      pattern: "CategorySection"
    - from: "src/components/CategorySection.tsx"
      to: "src/components/SoundCard.tsx"
      via: "FlatList horizontal renderItem"
      pattern: "SoundCard"
    - from: "src/components/SoundCard.tsx"
      to: "src/data/sounds.ts"
      via: "Sound type prop"
      pattern: "Sound"
    - from: "app/(tabs)/index.tsx"
      to: "router.push('/player')"
      via: "onPress on SoundCard"
      pattern: "router\\.push.*player"
    - from: "app/(tabs)/_layout.tsx"
      to: "expo-blur BlurView"
      via: "tabBarBackground prop"
      pattern: "BlurView"
---

<objective>
Install Phase 3 libraries, create the navigation shell (root Stack + Tabs + onboarding groups), define the static sound manifest, build the uiStore, and assemble the Sound Library screen — the entry point users land on after onboarding.

Purpose: This plan establishes the foundational data, state, and navigation structure that the Player screen (03-02) and remaining screens (03-03) depend on.
Output: A working library screen browsable by category sections with functional navigation to the player route, frosted-glass tab bar, and readable uiStore dark mode preference.
</objective>

<execution_context>
@/Users/manuelfrancogiraldez/.claude/get-shit-done/workflows/execute-plan.md
@/Users/manuelfrancogiraldez/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-core-ui/03-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Phase 3 libraries, define sound manifest, and create uiStore</name>
  <files>
    src/data/sounds.ts
    src/stores/uiStore.ts
    package.json
  </files>
  <action>
1. Install required libraries (these are not yet in the project — confirm by checking package.json first):
   ```bash
   npx expo install expo-video expo-blur expo-keep-awake react-native-svg expo-image expo-linear-gradient
   ```
   Note: @react-native-async-storage/async-storage and react-native-reanimated are already installed from Phase 1.

2. Create `src/data/sounds.ts` — the static sound manifest. Define a `Sound` TypeScript interface and export a `SOUNDS` array of 17 sounds across 4 categories. Use the existing sound files as reference (`sounds/rain/`, `sounds/fire/`, `sounds/forest/`, `sounds/wave/`):

   ```typescript
   export interface Sound {
     id: string;
     name: string;
     subtitle: string;  // short descriptor (e.g. "Heavy downpour")
     category: 'rain' | 'fire' | 'forest' | 'wave';
     duration: string;  // display string e.g. "1:30"
     durationSeconds: number;
     isPremium: boolean;
     imageAsset: string;  // placeholder color or asset path; use category-based color for now
   }

   export const SOUNDS: Sound[] = [
     // Rain (4-5 sounds)
     { id: 'rain-01', name: 'Heavy Rain', subtitle: 'Steady downpour', category: 'rain', duration: '2:00', durationSeconds: 120, isPremium: false, imageAsset: '#1a2535' },
     { id: 'rain-02', name: 'Light Drizzle', subtitle: 'Soft patter', category: 'rain', duration: '1:30', durationSeconds: 90, isPremium: false, imageAsset: '#1a2535' },
     { id: 'rain-03', name: 'Storm Thunder', subtitle: 'Rolling thunder', category: 'rain', duration: '3:00', durationSeconds: 180, isPremium: true, imageAsset: '#1a2535' },
     { id: 'rain-04', name: 'Rain on Glass', subtitle: 'Window tapping', category: 'rain', duration: '2:30', durationSeconds: 150, isPremium: true, imageAsset: '#1a2535' },
     // Fire (4-5 sounds)
     { id: 'fire-01', name: 'Campfire', subtitle: 'Crackling logs', category: 'fire', duration: '2:00', durationSeconds: 120, isPremium: false, imageAsset: '#2a1a0e' },
     { id: 'fire-02', name: 'Fireplace', subtitle: 'Gentle hearth', category: 'fire', duration: '3:00', durationSeconds: 180, isPremium: false, imageAsset: '#2a1a0e' },
     { id: 'fire-03', name: 'Bonfire', subtitle: 'Open flame', category: 'fire', duration: '2:30', durationSeconds: 150, isPremium: true, imageAsset: '#2a1a0e' },
     { id: 'fire-04', name: 'Ember Glow', subtitle: 'Dying embers', category: 'fire', duration: '1:30', durationSeconds: 90, isPremium: true, imageAsset: '#2a1a0e' },
     // Forest (4-5 sounds)
     { id: 'forest-01', name: 'Morning Birds', subtitle: 'Dawn chorus', category: 'forest', duration: '2:00', durationSeconds: 120, isPremium: false, imageAsset: '#0e1f10' },
     { id: 'forest-02', name: 'Deep Forest', subtitle: 'Rustling leaves', category: 'forest', duration: '3:00', durationSeconds: 180, isPremium: false, imageAsset: '#0e1f10' },
     { id: 'forest-03', name: 'Creek Flow', subtitle: 'Stream over rocks', category: 'forest', duration: '2:30', durationSeconds: 150, isPremium: true, imageAsset: '#0e1f10' },
     { id: 'forest-04', name: 'Wind in Pines', subtitle: 'Swaying canopy', category: 'forest', duration: '2:00', durationSeconds: 120, isPremium: true, imageAsset: '#0e1f10' },
     // Wave (4-5 sounds)
     { id: 'wave-01', name: 'Ocean Waves', subtitle: 'Rhythmic surf', category: 'wave', duration: '2:00', durationSeconds: 120, isPremium: false, imageAsset: '#0e1a2a' },
     { id: 'wave-02', name: 'Beach Shore', subtitle: 'Gentle lapping', category: 'wave', duration: '1:30', durationSeconds: 90, isPremium: false, imageAsset: '#0e1a2a' },
     { id: 'wave-03', name: 'Deep Sea', subtitle: 'Underwater calm', category: 'wave', duration: '3:00', durationSeconds: 180, isPremium: true, imageAsset: '#0e1a2a' },
     { id: 'wave-04', name: 'Storm Surge', subtitle: 'Crashing swells', category: 'wave', duration: '2:30', durationSeconds: 150, isPremium: true, imageAsset: '#0e1a2a' },
     { id: 'wave-05', name: 'Tide Pools', subtitle: 'Trickling pools', category: 'wave', duration: '2:00', durationSeconds: 120, isPremium: false, imageAsset: '#0e1a2a' },
   ];

   export const CATEGORIES: { id: Sound['category']; label: string }[] = [
     { id: 'rain', label: 'Rain' },
     { id: 'fire', label: 'Fire' },
     { id: 'forest', label: 'Forest' },
     { id: 'wave', label: 'Ocean' },
   ];

   export function getSoundsByCategory(category: Sound['category']): Sound[] {
     return SOUNDS.filter((s) => s.category === category);
   }
   ```

3. Create `src/stores/uiStore.ts` — Zustand persist store for dark mode and fullscreen state:

   ```typescript
   import { create } from 'zustand';
   import { persist, createJSONStorage } from 'zustand/middleware';
   import AsyncStorage from '@react-native-async-storage/async-storage';

   interface UIState {
     isDarkMode: boolean;
     isFullscreen: boolean;       // ephemeral — NOT persisted
     _hasHydrated: boolean;       // hydration guard — NOT persisted
     toggleDarkMode: () => void;
     setFullscreen: (value: boolean) => void;
     setHasHydrated: (value: boolean) => void;
   }

   export const useUIStore = create<UIState>()(
     persist(
       (set) => ({
         isDarkMode: true,
         isFullscreen: false,
         _hasHydrated: false,
         toggleDarkMode: () => set((s) => ({ isDarkMode: !s.isDarkMode })),
         setFullscreen: (value) => set({ isFullscreen: value }),
         setHasHydrated: (value) => set({ _hasHydrated: value }),
       }),
       {
         name: 'ui-storage',
         storage: createJSONStorage(() => AsyncStorage),
         partialize: (s) => ({ isDarkMode: s.isDarkMode }), // only isDarkMode is persisted
         onRehydrateStorage: () => (state) => {
           state?.setHasHydrated(true);
         },
       }
     )
   );
   ```

   isFullscreen is ephemeral (resets on app restart). _hasHydrated is the guard for preventing dark mode flash (see research pitfall 2).
  </action>
  <verify>
    ```bash
    cd /Users/manuelfrancogiraldez/Documents/2026/proyectos/calm-asmr-sounds
    # TypeScript check:
    npx tsc --noEmit 2>&1 | head -30
    # Verify sound count:
    node -e "const {SOUNDS} = require('./src/data/sounds.ts'); console.log(SOUNDS.length);" 2>/dev/null || grep -c "id:" src/data/sounds.ts
    ```
    SOUNDS array must have 17 items. TypeScript compilation must pass for these two files with no errors.
  </verify>
  <done>
    - `src/data/sounds.ts` exports Sound interface, SOUNDS array with 17 items (4 categories), CATEGORIES array, getSoundsByCategory function
    - `src/stores/uiStore.ts` exports useUIStore with isDarkMode (default true), isFullscreen (default false), _hasHydrated, and action functions
    - All Phase 3 libraries installed and in package.json (expo-video, expo-blur, expo-keep-awake, react-native-svg, expo-image, expo-linear-gradient)
  </done>
</task>

<task type="auto">
  <name>Task 2: Build SoundCard and CategorySection components</name>
  <files>
    src/components/SoundCard.tsx
    src/components/CategorySection.tsx
  </files>
  <action>
1. Create `src/components/SoundCard.tsx`:
   - Square card, `minWidth: 156`, aspect ratio 1:1, `borderRadius: 24`
   - Use `expo-image` `Image` component as the card background (fill entire card), with a fallback solid color from `sound.imageAsset` as background color when no image loads yet
   - Layer a `LinearGradient` from expo-linear-gradient over the image: transparent at top, `rgba(0,0,0,0.7)` at bottom — this is the gradient overlay
   - Text positioned at bottom of card: sound.name (white, fontSize 14, fontWeight '600'), sound.subtitle (white/60% opacity, fontSize 11), sound.duration (white/80% opacity, fontSize 11, in bottom-right corner or same row as subtitle)
   - PRO/lock badge in top-right corner:
     - If isPremium AND playing as locked (in Phase 3, treat all isPremium sounds as showing the PRO badge): render a small pill with label "PRO", background `rgba(139,92,246,0.2)`, border `rgba(139,92,246,0.4)`, text color `#8b5cf6`, fontSize 10, fontWeight '700', borderRadius 10, paddingHorizontal 6, paddingVertical 2
     - For simplicity in Phase 3: if isPremium show PRO badge. Lock badge (purple circle icon) is used in Phase 6 when actual gating is implemented.
   - onPress handler: call the router.push('/player') AND set the current sound in audioStore. Import useAudioStore to call setCurrentSound. If audioStore does not yet have setCurrentSound from Phase 2 plans, call router.push('/player') directly and pass sound.id as a route param: `router.push({ pathname: '/player', params: { soundId: sound.id } })`.
   - Color constants: background charcoal `#0f1115`, card bg `#1a1c22`, primary accent `#8b5cf6`

   ```typescript
   import { TouchableOpacity, View, Text, StyleSheet } from 'react-native';
   import { Image } from 'expo-image';
   import { LinearGradient } from 'expo-linear-gradient';
   import { router } from 'expo-router';
   import type { Sound } from '@/src/data/sounds';

   interface SoundCardProps {
     sound: Sound;
   }

   const CARD_SIZE = 156;

   export function SoundCard({ sound }: SoundCardProps) {
     const handlePress = () => {
       router.push({ pathname: '/player', params: { soundId: sound.id } });
     };

     return (
       <TouchableOpacity onPress={handlePress} activeOpacity={0.85} style={styles.card}>
         <Image
           source={{ uri: undefined }} // Phase 3: no remote image yet
           style={StyleSheet.absoluteFill}
           contentFit="cover"
         />
         {/* Solid color fallback background */}
         <View style={[StyleSheet.absoluteFill, { backgroundColor: sound.imageAsset as string }]} />
         {/* Gradient overlay */}
         <LinearGradient
           colors={['transparent', 'rgba(0,0,0,0.75)']}
           style={StyleSheet.absoluteFill}
           start={{ x: 0, y: 0.4 }}
           end={{ x: 0, y: 1 }}
         />
         {/* PRO badge */}
         {sound.isPremium && (
           <View style={styles.proBadge}>
             <Text style={styles.proText}>PRO</Text>
           </View>
         )}
         {/* Bottom text */}
         <View style={styles.textContainer}>
           <Text style={styles.soundName} numberOfLines={1}>{sound.name}</Text>
           <View style={styles.metaRow}>
             <Text style={styles.subtitle} numberOfLines={1}>{sound.subtitle}</Text>
             <Text style={styles.duration}>{sound.duration}</Text>
           </View>
         </View>
       </TouchableOpacity>
     );
   }

   const styles = StyleSheet.create({
     card: {
       width: CARD_SIZE,
       height: CARD_SIZE,
       borderRadius: 24,
       overflow: 'hidden',
       backgroundColor: '#1a1c22',
     },
     proBadge: {
       position: 'absolute',
       top: 10,
       right: 10,
       backgroundColor: 'rgba(139,92,246,0.2)',
       borderWidth: 1,
       borderColor: 'rgba(139,92,246,0.4)',
       borderRadius: 10,
       paddingHorizontal: 6,
       paddingVertical: 2,
     },
     proText: {
       color: '#8b5cf6',
       fontSize: 10,
       fontWeight: '700',
     },
     textContainer: {
       position: 'absolute',
       bottom: 10,
       left: 10,
       right: 10,
     },
     soundName: {
       color: '#ffffff',
       fontSize: 14,
       fontWeight: '600',
       marginBottom: 2,
     },
     metaRow: {
       flexDirection: 'row',
       justifyContent: 'space-between',
       alignItems: 'center',
     },
     subtitle: {
       color: 'rgba(255,255,255,0.6)',
       fontSize: 11,
       flex: 1,
     },
     duration: {
       color: 'rgba(255,255,255,0.8)',
       fontSize: 11,
       marginLeft: 4,
     },
   });
   ```

2. Create `src/components/CategorySection.tsx`:
   - Receives `category: string` (display label) and `sounds: Sound[]`
   - Renders a section title text (`Text`) above a horizontal FlatList
   - FlatList: `horizontal={true}`, `showsHorizontalScrollIndicator={false}`, `snapToAlignment="start"`, `decelerationRate="fast"`, `snapToInterval={156 + 16}` (card width + gap), `contentContainerStyle={{ paddingHorizontal: 24, gap: 16 }}`
   - Do NOT add any ScrollView wrapper — this component is always used as a renderItem inside a parent FlatList

   ```typescript
   import { View, Text, FlatList, StyleSheet } from 'react-native';
   import { SoundCard } from './SoundCard';
   import type { Sound } from '@/src/data/sounds';

   interface CategorySectionProps {
     category: string;
     sounds: Sound[];
   }

   export function CategorySection({ category, sounds }: CategorySectionProps) {
     return (
       <View style={styles.container}>
         <Text style={styles.title}>{category}</Text>
         <FlatList
           horizontal
           data={sounds}
           keyExtractor={(item) => item.id}
           renderItem={({ item }) => <SoundCard sound={item} />}
           showsHorizontalScrollIndicator={false}
           snapToAlignment="start"
           decelerationRate="fast"
           snapToInterval={156 + 16}
           contentContainerStyle={styles.listContent}
         />
       </View>
     );
   }

   const styles = StyleSheet.create({
     container: {
       marginBottom: 32,
     },
     title: {
       color: '#ffffff',
       fontSize: 20,
       fontWeight: '600',
       marginBottom: 16,
       paddingHorizontal: 24,
     },
     listContent: {
       paddingHorizontal: 24,
       gap: 16,
     },
   });
   ```
  </action>
  <verify>
    Verify TypeScript compiles without errors for both files:
    ```bash
    cd /Users/manuelfrancogiraldez/Documents/2026/proyectos/calm-asmr-sounds
    npx tsc --noEmit 2>&1 | grep -E "SoundCard|CategorySection" | head -20
    ```
    No TypeScript errors referencing these files.
  </verify>
  <done>
    - SoundCard renders: solid color background + gradient overlay + sound name + subtitle + duration + PRO badge when isPremium
    - CategorySection renders: section title + horizontal FlatList with snap behavior
    - Both components are TypeScript-clean with no `any` usage
    - SoundCard onPress calls router.push with soundId param
  </done>
</task>

<task type="auto">
  <name>Task 3: Wire root Stack layout, tab layout, and library screen</name>
  <files>
    app/_layout.tsx
    app/(tabs)/_layout.tsx
    app/(tabs)/index.tsx
    app/(tabs)/now-playing.tsx
    app/(tabs)/favorites.tsx
    app/(onboarding)/_layout.tsx
  </files>
  <action>
1. Create/replace `app/_layout.tsx` — root Stack with three sibling screens:
   - Call `SplashScreen.preventAutoHideAsync()` at module level (before the component function)
   - Root layout renders a `Stack` with three screens: `(onboarding)` (headerShown: false), `(tabs)` (headerShown: false), `player` (headerShown: false, presentation: 'fullScreenModal', animation: 'fade')
   - The onboarding routing logic belongs in Phase 3 plan 03-03 (not here yet — for now, the layout just declares the screens; routing is added in 03-03)

   ```typescript
   import { Stack } from 'expo-router';
   import * as SplashScreen from 'expo-splash-screen';

   SplashScreen.preventAutoHideAsync();

   export default function RootLayout() {
     return (
       <Stack>
         <Stack.Screen name="(onboarding)" options={{ headerShown: false }} />
         <Stack.Screen name="(tabs)" options={{ headerShown: false }} />
         <Stack.Screen
           name="player"
           options={{
             headerShown: false,
             presentation: 'fullScreenModal',
             animation: 'fade',
           }}
         />
       </Stack>
     );
   }
   ```

   Note: If a _layout.tsx already exists from Phase 1 (it was planned), merge this content with it — do not create a duplicate. Check for existing file first and integrate the Stack.Screen declarations.

2. Create/replace `app/(tabs)/_layout.tsx` — 4-tab Tabs navigator with frosted BlurView tab bar:
   - Import BlurView from expo-blur
   - Tab bar: `position: 'absolute'`, `borderTopWidth: 0`, `backgroundColor: 'transparent'`, `tabBarBackground` returns `BlurView` with `tint="dark"`, `intensity={80}`, `experimentalBlurMethod="dimezisBlurView"`, `style={StyleSheet.absoluteFill}`
   - 4 Tabs.Screen entries: `index` (title: 'Home', home icon), `now-playing` (title: 'Now Playing', graphic_eq / music-note icon), `favorites` (title: 'Favorites', heart icon), `settings` (title: 'Settings', gear icon)
   - Use icons from `@expo/vector-icons` MaterialIcons or Ionicons (whichever is already installed from Phase 1); for graphic_eq use `MaterialIcons` name `"graphic-eq"`, for home use `"home"`, for favorites use `"favorite"`, for settings use `"settings"`
   - Active tab icon color: `#8b5cf6` (primary), inactive: `rgba(255,255,255,0.4)`
   - tabBarActiveTintColor: `#8b5cf6`, tabBarInactiveTintColor: `rgba(255,255,255,0.4)`
   - tabBarLabelStyle: fontSize 10

3. Create `app/(tabs)/index.tsx` — Library screen:
   - Background color `#0f1115`
   - A header area (SafeAreaView or paddingTop: 60) with app name or logo text
   - Outer `FlatList` (vertical, no ScrollView wrapper) where `data={CATEGORIES}` and `renderItem` renders a `CategorySection` for each category
   - Each item in the FlatList is: `{ category, sounds: getSoundsByCategory(category.id) }`
   - Add `ListHeaderComponent` for the screen header ("Your Sounds" or the app name)
   - `contentContainerStyle={{ paddingBottom: 100 }}` to avoid content hidden behind frosted tab bar (since tab bar is position:absolute)

   ```typescript
   import { FlatList, View, Text, StyleSheet, SafeAreaView } from 'react-native';
   import { CategorySection } from '@/src/components/CategorySection';
   import { CATEGORIES, getSoundsByCategory } from '@/src/data/sounds';

   export default function LibraryScreen() {
     return (
       <View style={styles.container}>
         <FlatList
           data={CATEGORIES}
           keyExtractor={(item) => item.id}
           renderItem={({ item }) => (
             <CategorySection
               category={item.label}
               sounds={getSoundsByCategory(item.id)}
             />
           )}
           showsVerticalScrollIndicator={false}
           contentContainerStyle={styles.content}
           ListHeaderComponent={
             <View style={styles.header}>
               <Text style={styles.appTitle}>Calm Sounds</Text>
               <Text style={styles.subtitle}>Choose your sound</Text>
             </View>
           }
         />
       </View>
     );
   }

   const styles = StyleSheet.create({
     container: { flex: 1, backgroundColor: '#0f1115' },
     content: { paddingTop: 60, paddingBottom: 100 },
     header: { paddingHorizontal: 24, paddingBottom: 24 },
     appTitle: { color: '#ffffff', fontSize: 28, fontWeight: '700' },
     subtitle: { color: 'rgba(255,255,255,0.5)', fontSize: 15, marginTop: 4 },
   });
   ```

4. Create `app/(tabs)/now-playing.tsx` — Tab 2 shell:
   - On mount: check audioStore for currentSound. If currentSound is set, call `router.replace('/player')`. If not, render a "nothing playing" view.
   - "Nothing playing" view: centered text "No sound playing" in gray, with a small music icon above it. Do not navigate anywhere.

   ```typescript
   import { View, Text, StyleSheet } from 'react-native';
   import { router } from 'expo-router';
   import { useEffect } from 'react';
   // Import audioStore from Phase 2 — if audioStore does not exist yet, comment out and use null
   // import { useAudioStore } from '@/src/stores/audioStore';

   export default function NowPlayingTab() {
     // const currentSound = useAudioStore((s) => s.currentSound);
     const currentSound = null; // Phase 3: audioStore wired in Phase 2; use null as placeholder if not yet built

     useEffect(() => {
       if (currentSound) {
         router.replace('/player');
       }
     }, [currentSound]);

     return (
       <View style={styles.container}>
         <Text style={styles.icon}>♪</Text>
         <Text style={styles.text}>No sound playing</Text>
         <Text style={styles.sub}>Tap a sound in the library to begin</Text>
       </View>
     );
   }

   const styles = StyleSheet.create({
     container: { flex: 1, backgroundColor: '#0f1115', alignItems: 'center', justifyContent: 'center' },
     icon: { fontSize: 40, marginBottom: 16, color: 'rgba(255,255,255,0.2)' },
     text: { color: 'rgba(255,255,255,0.5)', fontSize: 18, fontWeight: '600' },
     sub: { color: 'rgba(255,255,255,0.3)', fontSize: 14, marginTop: 8, textAlign: 'center', paddingHorizontal: 40 },
   });
   ```

   After Phase 2 is confirmed built, uncomment the audioStore import and remove the `const currentSound = null` line.

5. Create `app/(tabs)/favorites.tsx` — Empty state shell (populated in Phase 4):
   - Centered empty state: heart icon, "No favorites yet", "Tap the heart on any sound to save it"
   - Background `#0f1115`

6. Create `app/(onboarding)/_layout.tsx` — Stack layout for onboarding screens (needed for Expo Router to recognize the group):
   ```typescript
   import { Stack } from 'expo-router';
   export default function OnboardingLayout() {
     return <Stack screenOptions={{ headerShown: false }} />;
   }
   ```
  </action>
  <verify>
    ```bash
    cd /Users/manuelfrancogiraldez/Documents/2026/proyectos/calm-asmr-sounds
    npx tsc --noEmit 2>&1 | head -40
    ```
    Run the dev server and verify app compiles:
    ```bash
    npx expo start --no-dev 2>&1 | head -20
    ```
    Confirm: no TypeScript errors in the modified files. App starts without "Unable to resolve module" errors.
  </verify>
  <done>
    - Root Stack declares three sibling screens: (onboarding), (tabs), player — no tab bar shows on player route
    - 4-tab navigator with frosted BlurView background renders; active tab icon is purple (#8b5cf6)
    - Library screen displays 4 CategorySection rows (Rain, Fire, Forest, Ocean) each with their sounds as horizontal scrolling cards
    - Tapping a SoundCard calls router.push to /player with soundId param
    - now-playing.tsx renders "No sound playing" shell (no crashes)
    - favorites.tsx renders empty state shell (no crashes)
    - app/(onboarding)/_layout.tsx exists for Expo Router group resolution
  </done>
</task>

</tasks>

<verification>
After all three tasks complete, verify the full plan outcome:

1. Library screen renders 17 sound cards across 4 category sections (count them visually or via data)
2. Each card shows: name, subtitle, duration, and PRO badge on premium sounds
3. Horizontal scroll works per category section — no "VirtualizedLists should never be nested" warning in Metro logs
4. Tab bar shows 4 tabs with frosted glass effect — content scrolls behind it
5. Tapping a sound card triggers navigation to /player route (player screen not yet built — expect a blank screen or 404, which is correct for this plan)
6. TypeScript compilation passes: `npx tsc --noEmit` exits 0
</verification>

<success_criteria>
- All 17 sounds from SOUNDS array are visible in the library (4 category sections)
- SoundCard renders correctly: image bg (solid color fallback), gradient, name, subtitle, duration, PRO badge
- CategorySection horizontal scroll snaps between cards with no nested FlatList warnings
- Root Stack has player as a sibling of (tabs) — confirmed by absence of tab bar when navigating to /player
- uiStore exports useUIStore with isDarkMode defaulting to true
- No TypeScript errors in modified files
</success_criteria>

<output>
After completion, create `.planning/phases/03-core-ui/03-01-SUMMARY.md` documenting:
- Libraries installed and versions
- Sound manifest structure (Sound interface fields)
- uiStore shape (fields and what is/isn't persisted)
- SoundCard props and rendering approach
- CategorySection props and FlatList config
- Navigation structure (which screens are siblings vs nested)
- Any deviations from this plan and why
</output>
