---
phase: 7-polish-dnd-and-analytics
plan: 04
type: execute
wave: 3
depends_on:
  - 07-03
files_modified:
  - eas.json
  - app.json
  - docs/release/phase-7-store-submission.md
autonomous: false
requirements:
  - VIS-03
  - ANLX-01

user_setup:
  - service: app-store-connect
    why: "TestFlight submission requires Apple account roles, certificates, and app metadata that Claude cannot fully provision"
    dashboard_config:
      - task: "Ensure app record, bundle identifier, and internal tester groups are configured"
        location: "App Store Connect -> My Apps -> Your App"
  - service: google-play-console
    why: "Internal testing rollout requires Play Console release setup and tester list"
    dashboard_config:
      - task: "Ensure internal testing track exists and tester emails/groups are configured"
        location: "Google Play Console -> Testing -> Internal testing"

must_haves:
  truths:
    - "A valid iOS build is uploaded and installable in TestFlight internal testing"
    - "A valid Android build is uploaded and installable in Play internal testing"
    - "Launch smoke tests confirm no crash on startup and core playback entry is reachable"
    - "Submission checklist records build IDs, upload timestamps, and tester validation status"
  artifacts:
    - path: "eas.json"
      provides: "Release-ready build/submit profiles for ios and android internal distribution"
      contains: "submit"
    - path: "app.json"
      provides: "Store metadata and runtime config aligned with release profiles"
      contains: "ios"
    - path: "docs/release/phase-7-store-submission.md"
      provides: "Execution log for EAS build+submit commands, build numbers, and install verification"
      min_lines: 60
  key_links:
    - from: "eas.json"
      to: "EAS Submit"
      via: "submit profiles target TestFlight and Play internal track"
      pattern: "submit"
    - from: "docs/release/phase-7-store-submission.md"
      to: "TestFlight + Play internal testing"
      via: "records install checks and crash-free launch status"
      pattern: "install"
---

<objective>
Complete launch-readiness delivery by producing and submitting internal-test builds to TestFlight and Google Play internal testing, with reproducible submission config and verification evidence.

Purpose: Phase 7 is only complete when validated binaries are live in both internal channels and install smoke tests pass.

Output: EAS build/submit profiles, release runbook, and documented internal-track verification.
</objective>

<execution_context>
@/Users/manuelfrancogiraldez/.claude/get-shit-done/workflows/execute-plan.md
@/Users/manuelfrancogiraldez/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/7-polish-dnd-and-analytics/7-RESEARCH.md
@.planning/phases/7-polish-dnd-and-analytics/07-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Finalize EAS release profiles and run build+submit pipeline</name>
  <files>
    eas.json
    app.json
  </files>
  <action>
Align `eas.json` build and submit profiles for iOS TestFlight and Android internal testing. Ensure profile names and credentials strategy are explicit and repeatable.

Run EAS pipeline commands for both platforms (`eas build` then `eas submit`) and capture resulting build IDs/URLs. Keep command output references in release documentation.

If authentication gates appear, follow execute-plan auth checkpoint behavior and resume command execution after user login.
  </action>
  <verify>
    Verify EAS build and submit complete successfully for iOS and Android. Confirm artifacts appear in TestFlight and Play internal track with matching version/build numbers.
  </verify>
  <done>
    - Release profiles are stable and reusable
    - Both platform submissions complete without blocking errors
    - Uploaded artifacts are visible in their internal testing consoles
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Checkpoint: Confirm internal-track install and launch smoke tests</name>
  <files>docs/release/phase-7-store-submission.md</files>
  <action>
Create a submission runbook entry with exact build IDs, upload times, tester channels, and smoke-test results from one iOS and one Android internal tester install.
  </action>
  <what-built>
    Submitted internal builds for TestFlight and Google Play internal testing plus release documentation.
  </what-built>
  <how-to-verify>
    1. Install iOS build from TestFlight and Android build from Play internal testing.
    2. Launch each build and verify no crash on startup.
    3. Start a playback session and verify player opens successfully.
    4. Verify DND/Quiet Session control is present in active playback session.
    5. Confirm paywall entry and one analytics-triggering action still function in release build.
    6. Record pass/fail and tester device details in `docs/release/phase-7-store-submission.md`.
  </how-to-verify>
  <verify>Human confirms both internal-track installs pass smoke checks or reports failing platform.</verify>
  <done>Both store internal builds are installable, launch crash-free, and pass baseline functional smoke tests.</done>
  <resume-signal>Type "approved" when both iOS and Android internal-track smoke checks pass.</resume-signal>
</task>

</tasks>

<verification>
Automated: EAS build + submit succeeds for iOS and Android.
Manual: internal tester install/launch smoke tests pass and are documented.
</verification>

<success_criteria>
- TestFlight internal build available and installable
- Play internal testing build available and installable
- No launch crash on either platform during smoke check
- Release runbook captures build identifiers and validation evidence
</success_criteria>

<output>
After completion and checkpoint approval, create `.planning/phases/7-polish-dnd-and-analytics/07-04-SUMMARY.md` with submission results, build links/IDs, and smoke-test outcomes.
</output>
